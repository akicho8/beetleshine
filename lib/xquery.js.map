{"version":3,"file":"xquery.js","names":["_xstring","require","_xhash","_lodash","_interopRequireDefault","obj","__esModule","default","Xquery","query_compact","str","hash","query_hash_from_str","compacted_hash","Xhash","hash_compact","query_hash_to_str","query_str_merge","params","_","each","v","k","queries","Xstring","str_split","pair_values","map","e","reduce","a","_ref","join","exports"],"sources":["../src/xquery.js"],"sourcesContent":["import { Xstring } from \"./xstring.js\"\nimport { Xhash } from \"./xhash.js\"\nimport _ from \"lodash\"\n\nexport const Xquery = {\n  // expect(Xquery.query_compact(\"a:b c\").toEqual(\"a:b\"))\n  query_compact(str) {\n    const hash = this.query_hash_from_str(str)\n    const compacted_hash = Xhash.hash_compact(hash)\n    return this.query_hash_to_str(compacted_hash)\n  },\n\n  // expect(Xquery.query_str_merge(\"a:b c:d\", {c:\"x\"})).toEqual(\"a:b c:x\")\n  query_str_merge(str, params) {\n    const hash = this.query_hash_from_str(str)\n    _.each(params, (v, k) => hash[k] = v)\n    return this.query_hash_to_str(hash)\n  },\n\n  // expect(Xquery.query_hash_from_str(\"a:b c:d\")).toEqual({a:\"b\", c:\"d\"})\n  query_hash_from_str(str) {\n    const queries = Xstring.str_split(str || \"\")\n    // const all = queries.filter(e => e.match(/.+:.+/))\n    const pair_values = queries.map(e => Xstring.str_split(e, /:/))\n    const hash = pair_values.reduce((a, [k, v]) => ({...a, [k]: v}), {})\n    return hash\n  },\n\n  // expect(Xquery.query_hash_to_str({a:\"b\", c:\"d\"})).toEqual(\"a:b c:d\")\n  query_hash_to_str(hash) {\n    return _.map(hash, (v, k) => [k, v].join(\":\")).join(\" \")\n  },\n}\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,MAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAC,sBAAA,CAAAH,OAAA;AAAsB,SAAAG,uBAAAC,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAEf,MAAMG,MAAM,GAAG;EAEpBC,aAAaA,CAACC,GAAG,EAAE;IACjB,MAAMC,IAAI,GAAG,IAAI,CAACC,mBAAmB,CAACF,GAAG,CAAC;IAC1C,MAAMG,cAAc,GAAGC,YAAK,CAACC,YAAY,CAACJ,IAAI,CAAC;IAC/C,OAAO,IAAI,CAACK,iBAAiB,CAACH,cAAc,CAAC;EAC/C,CAAC;EAGDI,eAAeA,CAACP,GAAG,EAAEQ,MAAM,EAAE;IAC3B,MAAMP,IAAI,GAAG,IAAI,CAACC,mBAAmB,CAACF,GAAG,CAAC;IAC1CS,eAAC,CAACC,IAAI,CAACF,MAAM,EAAE,CAACG,CAAC,EAAEC,CAAC,KAAKX,IAAI,CAACW,CAAC,CAAC,GAAGD,CAAC,CAAC;IACrC,OAAO,IAAI,CAACL,iBAAiB,CAACL,IAAI,CAAC;EACrC,CAAC;EAGDC,mBAAmBA,CAACF,GAAG,EAAE;IACvB,MAAMa,OAAO,GAAGC,gBAAO,CAACC,SAAS,CAACf,GAAG,IAAI,EAAE,CAAC;IAE5C,MAAMgB,WAAW,GAAGH,OAAO,CAACI,GAAG,CAACC,CAAC,IAAIJ,gBAAO,CAACC,SAAS,CAACG,CAAC,EAAE,GAAG,CAAC,CAAC;IAC/D,MAAMjB,IAAI,GAAGe,WAAW,CAACG,MAAM,CAAC,CAACC,CAAC,EAAAC,IAAA;MAAA,IAAE,CAACT,CAAC,EAAED,CAAC,CAAC,GAAAU,IAAA;MAAA,OAAM;QAAC,GAAGD,CAAC;QAAE,CAACR,CAAC,GAAGD;MAAC,CAAC;IAAA,CAAC,EAAE,CAAC,CAAC,CAAC;IACpE,OAAOV,IAAI;EACb,CAAC;EAGDK,iBAAiBA,CAACL,IAAI,EAAE;IACtB,OAAOQ,eAAC,CAACQ,GAAG,CAAChB,IAAI,EAAE,CAACU,CAAC,EAAEC,CAAC,KAAK,CAACA,CAAC,EAAED,CAAC,CAAC,CAACW,IAAI,CAAC,GAAG,CAAC,CAAC,CAACA,IAAI,CAAC,GAAG,CAAC;EAC1D;AACF,CAAC;AAAAC,OAAA,CAAAzB,MAAA,GAAAA,MAAA"}